@inherits LayoutComponentBase

<div class="cs-shell">
  <nav class="cs-nav">
    <NavLink href="/dashboard" class="cs-badge nav-brand" aria-label="Go to dashboard">
      <img src="images/logo.png" alt="CarSpec logo" />
      <span class="cs-title">CarSpec</span>
    </NavLink>

    <span class="nav-spacer"></span>

    <button class="cs-btn nav-theme" @onclick="ToggleTheme">
      <span>@(isDark ? "🌙 Dark" : "☀️ Light")</span>
    </button>

    <div class="nav-links">
      <NavLink href="/dashboard" class="cs-btn nav-link-btn" Match="NavLinkMatch.All">Home</NavLink>
      <NavLink href="/codes" class="cs-btn nav-link-btn">Codes</NavLink>
      <NavLink href="/garage" class="cs-btn nav-link-btn">Garage</NavLink>
      <NavLink href="/blescan" class="cs-btn nav-link-btn">Bluetooth</NavLink>
    </div>
  </nav>

  <main class="container cs-main">
    @Body
  </main>

  <footer class="cs-footer">
    © @DateTime.Now.Year CarSpec
  </footer>

  @* --- Mobile bottom nav --- *@
  <nav class="cs-bottom-nav">
      <NavLink href="/dashboard" class="bottom-nav-item" Match="NavLinkMatch.All">
          <span class="icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                  <!-- Home icon -->
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M21.4498 10.275L11.9998 3.1875L2.5498 10.275L2.9998 11.625H3.7498V20.25H20.2498V11.625H20.9998L21.4498 10.275ZM5.2498 18.75V10.125L11.9998 5.0625L18.7498 10.125V18.75H14.9999V14.3333L14.2499 13.5833H9.74988L8.99988 14.3333V18.75H5.2498ZM10.4999 18.75H13.4999V15.0833H10.4999V18.75Z" fill="currentColor"/>
              </svg>
          </span>
          <span class="label">Home</span>
      </NavLink>
  
      <NavLink href="/codes" class="bottom-nav-item">
          <span class="icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                  <!-- Warning / code icon -->
                  <path d="M12 16H12.01M12 11V13M14 8V5M11 5H17M6 12H3M3 9V15M21 11V19M6 8V16H8L10 19H18V10L16 8H6Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
          </span>
          <span class="label">Codes</span>
      </NavLink>
  
      <NavLink href="/garage" class="bottom-nav-item">
          <span class="icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                  <!-- Car / garage icon -->
                  <path d="M6 20H3V6L12 4L21 6V20H18M6 20H18M6 20V16M18 20V16M6 12V8L18 8V12M6 12L18 12M6 12V16M18 12V16M6 16H18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
          </span>
          <span class="label">Garage</span>
      </NavLink>
  
      <NavLink href="/blescan" class="bottom-nav-item">
          <span class="icon">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                  <!-- Bluetooth icon -->
                  <path d="M7 17L17 7L12 2V22L17 17L7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
          </span>
          <span class="label">Bluetooth</span>
      </NavLink>
  </nav>
</div>

@code {
  bool isDark = true;
  [Inject] IJSRuntime JS { get; set; } = default!;

  protected override async Task OnAfterRenderAsync(bool firstRender)
  {
    if (firstRender)
      await ApplyThemeAsync();
  }

  async Task ToggleTheme()
  {
    isDark = !isDark;
    await ApplyThemeAsync();
    StateHasChanged();
  }

  async Task ApplyThemeAsync()
  {
    var theme = isDark ? "dark" : "light";
    await JS.InvokeVoidAsync("document.documentElement.setAttribute", "data-theme", theme);
  }
}